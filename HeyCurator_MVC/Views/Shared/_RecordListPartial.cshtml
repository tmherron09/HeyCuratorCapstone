
@model List<Record>


@{
    List<ItemInStorage> iis = new List<ItemInStorage>();
    foreach (var record in Model)
    {
        iis.Add(_context.ItemInStorages.Where(s => s.ItemInStorageId == record.ItemInStorageId).Include(inst => inst.Item).FirstOrDefault());
    }
    List<Storage> storages = new List<Storage>();
    foreach (var item in iis)
    {
        storages.Add(_context.Storages.Where(s => s.StorageId == item.StorageId).FirstOrDefault());
    }
}


<table id="tablePreview" class="table table-striped table-hover table-sm table-bordered mb-0 text-center">
    <thead>
        <tr>
            <th>
                Storage
            </th>
            <th>
                Amount Recorded
            </th>
            <th>
                Minimum Recommended
            </th>
            <th>
                Recorded By
            </th>
            <th>
                Date Recorded
            </th>
            <th>
                Notes
            </th>
            <th>
                Curator Reported
            </th>
        </tr>
    </thead>
    <tbody>
        @for (int i = 0; i < Model.Count(); i++)
        {
            var bgColor = "";
            bgColor = (Model[i].RecordedCount < iis[i].Item.MinCount) ? "bg-totem-pole-200" : ((i % 2 == 0) ? "bg-white" : "bg-saffron-100");
            
            <tr onclick="updateRecordModal(this)" data-id="@Model[i].RecordId">
                <td class="@bgColor">
                    @storages[i].Name
                </td>
                <td class="@bgColor">
                    @Model[i].RecordedCount
                </td>
                <td class="@bgColor">
                    @iis[i].Item.MinCount
                </td>
                <td class="@bgColor">
                    @Model[i].Employee.EmployeeUserName
                </td>
                <td class="@bgColor">
                    @Model[i].TimeStamp
                </td>
                <td class="@bgColor">
                    @Model[i].RecordNote
                </td>
                <td class=" @bgColor grid h-100">
                    @if (Model[i].CuratorVerified)
                    {
                        <i class="gg-check-o mx-auto my-auto place-self-center"></i>
                    }
                    else
                    {
                        <i class="gg-shape-circle mx-auto my-auto place-self-center"></i>
                    }
                </td>
            </tr>
        }
    </tbody>
</table>


